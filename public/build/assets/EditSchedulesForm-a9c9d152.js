import{J as oe,r as v,i as ae,q as N,v as re,O as D,d as h,b as o,w as i,l as y,m as _,a as e,F as $,g as ie,o as d,f as m,u as r,y as R,c as F,z as w,e as j,D as de,n as ne,t as c}from"./app-262a2786.js";import{_ as g}from"./TextInput-bbe8df5b.js";import{_ as C}from"./SecondaryButton-d3277a63.js";import{_ as ue}from"./DangerButton-8bd23b7f.js";import{_ as me}from"./FormSectionWide-371a92bf.js";import{_ as B}from"./PrimaryButton-a709ea04.js";import{_ as ce}from"./DialogModal-370dc470.js";import{_ as u}from"./InputError-5f2d5f55.js";import{_ as n}from"./InputLabel-0afd5ac9.js";import{T as fe}from"./ToggleButton-2e04d601.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./Modal-e32cf43d.js";const pe=e("div",{style:{width:"50%",float:"left","text-align":"left"}},[e("span",null,"Schedule:")],-1),he={style:{width:"50%",float:"left","text-align":"right"}},ye={id:"alertnotification",class:"flex justify-end items-center scala-alert text-white text-sm font-bold px-4 py-3",role:"alert"},ge=e("svg",{class:"fill-current w-4 h-4 mr-2",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[e("path",{d:"M12.432 0c1.34 0 2.01.912 2.01 1.957 0 1.305-1.164 2.512-2.679 2.512-1.269 0-2.009-.75-1.974-1.99C9.789 1.436 10.67 0 12.432 0zM8.309 20c-1.058 0-1.833-.652-1.093-3.524l1.214-5.092c.211-.814.246-1.141 0-1.141-.317 0-1.689.562-2.502 1.117l-.528-.88c2.572-2.186 5.531-3.467 6.801-3.467 1.057 0 1.233 1.273.705 3.23l-1.391 5.352c-.246.945-.141 1.271.106 1.271.317 0 1.357-.392 2.379-1.207l.6.814C12.098 19.02 9.365 20 8.309 20z"})],-1),be=["innerHTML"],ve={class:"px-4 py-3 justify-end"},_e=e("title",null,"Close",-1),xe=e("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"},null,-1),Ce=[_e,xe],Fe={class:"px-2"},we={class:"px-2"},ke=e("option",{value:"pedestrian"}," Pedestrian ",-1),Ve=e("option",{value:"pedestrian_emergency"}," Pedestrian Emergency ",-1),Ee=[ke,Ve],Me={class:"px-2"},Se={key:0,class:"px-2"},Ue={key:1,class:"px-2"},qe={key:2,class:"px-2"},Be={class:"px-2"},Le={key:0},Te={key:1},Ie=["src"],Ne={class:"schedule-edit-form-actions"},De={class:"schedule-edit-show-fields"},$e={class:"schedule-edit-form-buttons"},Re=["href"],je={class:"schedule-fields-container"},Ae={class:"min-w-full divide-y divide-gray-200 border-separate"},Oe=e("thead",{class:"bg-gray-200 border"},[e("tr",null,[e("th",{scope:"col",class:"px-2 py-3 text-xs font-bold text-left text-gray-700 border"}," Name "),e("th",{scope:"col",class:"px-2 py-3 text-xs font-bold text-left text-gray-700 border"}," Type "),e("th",{scope:"col",class:"px-2 py-3 text-xs font-bold text-left text-gray-700 border"}," Label "),e("th",{scope:"col",class:"px-2 py-3 text-xs font-bold text-left text-gray-700 border"}," Required? "),e("th",{scope:"col",style:{"max-width":"100px"},class:"px-2 py-3 text-xs font-bold text-left text-gray-700 border"}," Data "),e("th",{scope:"col",class:"px-2 py-3 text-xs font-bold text-left text-gray-700 border"}," Max "),e("th",{scope:"col",class:"px-2 py-3 text-xs font-bold text-left text-gray-700 border"}," Min "),e("th",{scope:"col",class:"px-2 py-3 text-xs font-bold text-left text-gray-700 border"}," Lines "),e("th",{scope:"col",class:"px-2 py-3 text-xs font-bold text-left text-gray-700 border"}," Default ")])],-1),Pe=["id"],ze={class:"px-2 py-4 text-sm font-medium text-gray-800 whitespace-nowrap border"},He={class:"px-2 py-4 text-sm font-medium text-gray-800 whitespace-nowrap border"},Je={class:"px-2 py-4 text-sm font-medium text-gray-800 whitespace-nowrap border"},Ye={class:"px-2 py-4 text-sm font-medium text-gray-800 whitespace-nowrap border"},Ge={class:"px-2 py-4 text-sm font-medium text-gray-800 whitespace-nowrap border",style:{"max-width":"200px"}},Ke={class:"px-2 py-4 text-sm font-medium text-gray-800 whitespace-nowrap border"},Qe={class:"px-2 py-4 text-sm font-medium text-gray-800 whitespace-nowrap border"},We={class:"px-2 py-4 text-sm font-medium text-gray-800 whitespace-nowrap border"},Xe={class:"px-2 py-4 text-sm font-medium text-gray-800 whitespace-nowrap border"},Ze={class:"schedule-fields-modal-grid"},et={class:"px-2"},tt={class:"px-2"},lt=e("option",{value:"string"}," String ",-1),st=e("option",{value:"integer"}," Integer ",-1),ot=e("option",{value:"font"}," Font ",-1),at=e("option",{value:"picker"}," Color Picker ",-1),rt=e("option",{value:"select"}," Drop Down ",-1),it=e("option",{value:"textarea"}," Text Box ",-1),dt=[lt,st,ot,at,rt,it],nt={class:"px-2"},ut={class:"px-2"},mt={class:"px-2"},ct={class:"px-2"},ft={class:"px-2"},pt={class:"px-2"},ht=e("span",{style:{width:"20px"}},null,-1),Mt={__name:"EditSchedulesForm",props:{schedule:{type:Object,default:()=>({})},schedules:{type:Object,default:()=>({})},canEditSchedules:{type:Boolean,default:()=>!1},canAddSchedules:{type:Boolean,default:()=>!1},canDeleteSchedules:{type:Boolean,default:()=>!1},canAddFields:{type:Boolean,default:()=>!1},formMode:{type:String,default:()=>""}},setup(k){const f=k,L=oe(),V=v(!1);let E=v("");const M=ae({get(){return E.value?E.value:L.props.flash.message},set(t){E.value=t}}),T=()=>{V.value=!0,document.getElementById("alertnotification")&&(document.getElementById("alertnotification").style="display:justify;")},A=()=>{V.value=!1,document.getElementById("alertnotification")&&(document.getElementById("alertnotification").style="display:none;")};N(L.props,function(t){t!=null&&t.flashMessage&&T()},{immediate:!0,deep:!0}),N(M,(t,l)=>{t&&T()},{immediate:!0,deep:!0});const x=v(null),b=v(null),p=v(null),S=v(!1),U=v(!1),a=re("editSchedules",{_method:"PUT",id:f.schedules.id,name:f.schedules.name,category:f.schedules.category,description:f.schedules.description,full_url:f.schedules.full_url,thumbnail:f.schedules.thumbnail,fields:f.schedules.fields,photo:null,manifest:null}),O=()=>{U.value=!U.value},P=()=>{S.value=!0},z=()=>{fieldCreateForm.clearErrors(),fieldCreateForm.type==""&&fieldCreateForm.setError("type","Type required."),fieldCreateForm.name==""&&fieldCreateForm.setError("name","Name required."),fieldCreateForm.label==""&&fieldCreateForm.setError("label","Label required."),fieldCreateForm.default==""&&fieldCreateForm.setError("default","Default value required."),fieldCreateForm.required==""&&fieldCreateForm.setError("required","Required required."),(fieldCreateForm.type=="string"||fieldCreateForm.type=="integer")&&fieldCreateForm.max==""&&fieldCreateForm.setError("max","Max required."),(fieldCreateForm.type=="string"||fieldCreateForm.type=="integer")&&fieldCreateForm.min==""&&fieldCreateForm.setError("min","Min required."),(fieldCreateForm.type=="string"||fieldCreateForm.type=="integer")&&fieldCreateForm.lines==""&&fieldCreateForm.setError("min","Lines required."),!(Object.keys(fieldCreateForm.errors).length>0)&&fieldCreateForm.post(route("schedule_fields.store"),{onSuccess:()=>q(),onError:()=>fieldCreateForm.focus(),onFinish:()=>fieldCreateForm.reset()})},H=()=>{const t=b.value.files[0];if(!t)return;const l=new FileReader;l.onload=s=>{x.value=s.target.result},l.readAsDataURL(t)},J=()=>{const t=p.value.files[0];if(!t)return;const l=new FileReader;l.onload=s=>{a.full_url=s.target.result},l.readAsDataURL(t)},Y=()=>{b.value.click()},G=()=>{D.delete(route("schedule_thumb.destroy",f.schedules.id),{preserveScroll:!0,preserveState:!1,resetOnSuccess:!0,onSuccess:()=>{x.value=null,Z()}})},K=()=>{a.clearErrors(),b.value&&(a.photo=b.value.files[0]),p.value&&(a.manifest=p.value.files[0]),a.name==""&&(a.setError("name","Schedule Name required."),document.getElementById("schedule_name").classList.add("form-error-input")),!(Object.keys(a.errors).length>0)&&(f.formMode=="edit"?a.post(route("schedules.update"),{onError:()=>a.focus(),onFinish:()=>a.reset()}):a.post(route("schedules.store"),{onError:()=>a.focus(),onFinish:()=>a.reset()}))},Q=()=>{p.value.click()},W=()=>{X()};p.value&&(a.full_url=p.value.files[0]);const X=()=>{var t;(t=p.value)!=null&&t.value&&(p.value.value=null),a.full_url="",a.manifest=null},Z=()=>{var t;(t=b.value)!=null&&t.value&&(b.value.value=null)},q=()=>{S.value=!1};let I=[];const ee=t=>{let l="";return typeof t=="object"?(l+="Problem updating schedule! (records with issues marked in red)<br/>",Object.entries(t).forEach(s=>{const[le,se]=s;I.push(le),l+=se}),l):t},te=t=>{t.forEach(l=>{document.getElementById(l)!==null&&(document.getElementById(l).className="schedule-row-color-error")})};return D.on("success",()=>{te(I)}),(t,l)=>(d(),h($,null,[o(me,null,{title:i(()=>[pe,e("div",he,[y(o(B,{onClick:l[0]||(l[0]=s=>P())},{default:i(()=>[m(" Add Field ")]),_:1},512),[[_,k.canAddFields]])])]),form:i(()=>[y(e("div",ye,[ge,e("p",{innerHTML:r(M)?ee(r(M)):""},null,8,be),e("span",ve,[(d(),h("svg",{class:"fill-current h-6 w-6 text-indigo-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",onClick:l[1]||(l[1]=s=>A())},Ce))])],512),[[_,V.value]]),e("div",{class:ne(r(a).thumbnail||x.value?"grid grid-cols-5 gap-2 bg-gray-50 border py-4":"grid grid-cols-4 gap-2 bg-gray-50 border py-4")},[e("div",Fe,[o(n,{for:"name",value:"Name"}),o(g,{id:"schedule_name",modelValue:r(a).name,"onUpdate:modelValue":l[2]||(l[2]=s=>r(a).name=s),name:"name",type:"text",class:"block w-full"},null,8,["modelValue"]),o(u,{message:r(a).errors.name},null,8,["message"])]),e("div",we,[o(n,{for:"category",value:"Category"}),y(e("select",{id:"category","onUpdate:modelValue":l[3]||(l[3]=s=>r(a).category=s),name:"category",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm schedule-fields-modal-category"},Ee,512),[[R,r(a).category]]),o(u,{message:r(a).errors.category},null,8,["message"])]),e("div",Me,[o(n,{for:"description",value:"Description"}),o(g,{id:"description",modelValue:r(a).description,"onUpdate:modelValue":l[4]||(l[4]=s=>r(a).description=s),name:"description",type:"text",class:"block w-full"},null,8,["modelValue"]),o(u,{message:r(a).errors.description},null,8,["message"])]),t.manifestUpload?(d(),h("div",Se,[o(n,{for:"full_url",value:"Manifest",class:"hidden"}),r(a).full_url?(d(),F(C,{key:0,type:"button",class:"mt-2 schedule-fields-modal-thumb-btn",onClick:w(W,["prevent"])},{default:i(()=>[m(" Remove URL ")]),_:1},8,["onClick"])):(d(),F(C,{key:1,class:"mt-2 schedule-fields-modal-thumb-btn",type:"button",onClick:w(Q,["prevent"])},{default:i(()=>[m(" Set URL ")]),_:1},8,["onClick"])),e("input",{ref_key:"manifestInput",ref:p,type:"file",class:"hidden",onChange:J},null,544),o(u,{message:r(a).errors.full_url,class:"mt-2"},null,8,["message"])])):(d(),h("div",Ue,[o(n,{for:"full_url",value:"Full URL"}),o(g,{id:"full_url",modelValue:r(a).full_url,"onUpdate:modelValue":l[5]||(l[5]=s=>r(a).full_url=s),name:"full_url",type:"text",class:"block w-full"},null,8,["modelValue"]),o(u,{message:r(a).errors.full_url},null,8,["message"])])),t.thumbnailUpload?(d(),h("div",qe,[r(a).thumbnail?(d(),F(C,{key:0,type:"button",class:"mt-2 schedule-fields-modal-thumb-btn",onClick:w(G,["prevent"])},{default:i(()=>[m(" Remove Thumbnail ")]),_:1},8,["onClick"])):(d(),F(C,{key:1,class:"mt-2 schedule-fields-modal-thumb-btn",type:"button",onClick:w(Y,["prevent"])},{default:i(()=>[m(" Upload Thumbnail ")]),_:1},8,["onClick"])),o(u,{message:r(a).errors.thumbnail,class:"mt-2"},null,8,["message"])])):j("",!0),y(e("div",Be,[o(n,{for:"thumbnail",value:"Thumbnail"}),e("input",{ref_key:"photoInput",ref:b,type:"file",class:"hidden",onChange:H},null,544),x.value&&!r(a).thumbnail?(d(),h("div",Le,[e("span",{class:"schedule-thumbnail-preview",style:de("background-image: url('"+x.value+"');")},null,4)])):(d(),h("div",Te,[e("img",{class:"schedule-thumbnail-image",src:t.$page.props.schedules.thumbnail_photo_url,alt:"schedule-thumbnail"},null,8,Ie)]))],512),[[_,r(a).thumbnail||x.value]])],2)]),actions:i(()=>[e("div",Ne,[e("div",De,[k.canAddFields?(d(),F(B,{key:0,onClick:O},{default:i(()=>[m(" Show Fields ")]),_:1})):j("",!0)]),e("div",$e,[e("a",{href:t.route("schedules.index")},[o(C,{type:"button",class:"mr-2"},{default:i(()=>[m(" Cancel ")]),_:1})],8,Re),o(B,{onClick:K},{default:i(()=>[m(" Save Schedule ")]),_:1})])])]),_:1}),y(e("div",je,[e("table",Ae,[Oe,e("tbody",null,[(d(!0),h($,null,ie(t.scheduleFields,s=>(d(),h("tr",{id:s.id,key:s.id},[e("td",ze,c(s.name),1),e("td",He,c(s.type),1),e("td",Je,c(s.label),1),e("td",Ye,c(s.required),1),e("td",Ge,[e("pre",null,c(s.json_data),1)]),e("td",Ke,c(s.max),1),e("td",Qe,c(s.min),1),e("td",We,c(s.lines),1),e("td",Xe,c(s.default),1)],8,Pe))),128))])])],512),[[_,U.value]]),o(ce,{show:S.value,"max-width":"max",onClose:l[15]||(l[15]=s=>q())},{title:i(()=>[e("span",null,[e("b",null,c(r(a).name),1),m(" Field:")])]),content:i(()=>[e("div",Ze,[e("div",et,[o(n,{for:"name",value:"Name"}),o(g,{id:"name",modelValue:t.fieldCreateForm.name,"onUpdate:modelValue":l[6]||(l[6]=s=>t.fieldCreateForm.name=s),name:"name",type:"text",class:"block w-full"},null,8,["modelValue"]),o(u,{message:t.fieldCreateForm.errors.name},null,8,["message"])]),e("div",tt,[o(n,{for:"type",value:"Type"}),y(e("select",{id:"type","onUpdate:modelValue":l[7]||(l[7]=s=>t.fieldCreateForm.type=s),name:"type",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm planners-edit-class-code-input schedule-field-select"},dt,512),[[R,t.fieldCreateForm.type]]),o(u,{message:t.fieldCreateForm.errors.type},null,8,["message"])]),e("div",nt,[o(n,{for:"label",value:"Label"}),o(g,{id:"label",modelValue:t.fieldCreateForm.label,"onUpdate:modelValue":l[8]||(l[8]=s=>t.fieldCreateForm.label=s),name:"label",type:"text",class:"block w-full"},null,8,["modelValue"]),o(u,{message:t.fieldCreateForm.errors.label},null,8,["message"])]),e("div",ut,[o(n,{for:"default",value:"Default"}),o(g,{id:"default",modelValue:t.fieldCreateForm.default,"onUpdate:modelValue":l[9]||(l[9]=s=>t.fieldCreateForm.default=s),name:"default",type:"text",class:"block w-full"},null,8,["modelValue"]),o(u,{message:t.fieldCreateForm.errors.default},null,8,["message"])]),y(e("div",mt,[o(n,{for:"max",value:"Max"}),o(g,{id:"max",modelValue:t.fieldCreateForm.max,"onUpdate:modelValue":l[10]||(l[10]=s=>t.fieldCreateForm.max=s),name:"max",type:"text",class:"block w-full"},null,8,["modelValue"]),o(u,{message:t.fieldCreateForm.errors.max},null,8,["message"])],512),[[_,t.fieldCreateForm.type=="string"||t.fieldCreateForm.type=="integer"||t.fieldCreateForm.type=="textarea"]]),y(e("div",ct,[o(n,{for:"min",value:"Min"}),o(g,{id:"min",modelValue:t.fieldCreateForm.min,"onUpdate:modelValue":l[11]||(l[11]=s=>t.fieldCreateForm.min=s),name:"min",type:"text",class:"block w-full"},null,8,["modelValue"]),o(u,{message:t.fieldCreateForm.errors.min},null,8,["message"])],512),[[_,t.fieldCreateForm.type=="string"||t.fieldCreateForm.type=="integer"||t.fieldCreateForm.type=="textarea"]]),y(e("div",ft,[o(n,{for:"lines",value:"Lines"}),o(g,{id:"lines",modelValue:t.fieldCreateForm.lines,"onUpdate:modelValue":l[12]||(l[12]=s=>t.fieldCreateForm.lines=s),name:"lines",type:"text",class:"block w-full"},null,8,["modelValue"]),o(u,{message:t.fieldCreateForm.errors.lines},null,8,["message"])],512),[[_,t.fieldCreateForm.type=="string"||t.fieldCreateForm.type=="integer"||t.fieldCreateForm.type=="textarea"]]),e("div",pt,[o(n,{for:"required",value:"Required?"}),o(fe,{modelValue:t.fieldCreateForm.required,"onUpdate:modelValue":l[13]||(l[13]=s=>t.fieldCreateForm.required=s),onlabel:"Yes",offlabel:"No",labelledby:"toggle-label",describedby:"toggle-description","false-value":"0","true-value":"1",classes:{container:"mt-2 focus:ring focus:ring-white-500 focus:ring-opacity-30"}},null,8,["modelValue"])])])]),footer:i(()=>[o(C,{onClick:l[14]||(l[14]=s=>q())},{default:i(()=>[m(" Cancel ")]),_:1}),ht,o(ue,{onClick:z},{default:i(()=>[m(" Save ")]),_:1})]),_:1},8,["show"])],64))}};export{Mt as default};
