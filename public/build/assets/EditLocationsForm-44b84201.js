import{J as se,r as v,i as ae,q as N,v as re,O as D,d as y,b as s,w as i,l as g,m as _,a as e,F as $,g as ie,o as n,f as m,u as r,y as R,c as F,z as w,e as j,D as ne,n as de,t as c}from"./app-262a2786.js";import{_ as h}from"./TextInput-bbe8df5b.js";import{_ as C}from"./SecondaryButton-d3277a63.js";import{_ as ue}from"./DangerButton-8bd23b7f.js";import{_ as me}from"./FormSectionWide-371a92bf.js";import{_ as B}from"./PrimaryButton-a709ea04.js";import{_ as ce}from"./DialogModal-370dc470.js";import{_ as u}from"./InputError-5f2d5f55.js";import{_ as d}from"./InputLabel-0afd5ac9.js";import{T as fe}from"./ToggleButton-2e04d601.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./Modal-e32cf43d.js";const pe=e("div",{style:{width:"50%",float:"left","text-align":"left"}},[e("span",null,"Location:")],-1),ye={style:{width:"50%",float:"left","text-align":"right"}},ge={id:"alertnotification",class:"flex justify-end items-center scala-alert text-white text-sm font-bold px-4 py-3",role:"alert"},he=e("svg",{class:"fill-current w-4 h-4 mr-2",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[e("path",{d:"M12.432 0c1.34 0 2.01.912 2.01 1.957 0 1.305-1.164 2.512-2.679 2.512-1.269 0-2.009-.75-1.974-1.99C9.789 1.436 10.67 0 12.432 0zM8.309 20c-1.058 0-1.833-.652-1.093-3.524l1.214-5.092c.211-.814.246-1.141 0-1.141-.317 0-1.689.562-2.502 1.117l-.528-.88c2.572-2.186 5.531-3.467 6.801-3.467 1.057 0 1.233 1.273.705 3.23l-1.391 5.352c-.246.945-.141 1.271.106 1.271.317 0 1.357-.392 2.379-1.207l.6.814C12.098 19.02 9.365 20 8.309 20z"})],-1),be=["innerHTML"],ve={class:"px-4 py-3 justify-end"},_e=e("title",null,"Close",-1),xe=e("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"},null,-1),Ce=[_e,xe],Fe={class:"px-2"},we={class:"px-2"},ke=e("option",{value:"pedestrian"}," Pedestrian ",-1),Ve=e("option",{value:"pedestrian_emergency"}," Pedestrian Emergency ",-1),Ee=[ke,Ve],Le={class:"px-2"},Me={key:0,class:"px-2"},Ue={key:1,class:"px-2"},qe={key:2,class:"px-2"},Be={class:"px-2"},Te={key:0},Se={key:1},Ie=["src"],Ne={class:"location-edit-form-actions"},De={class:"location-edit-show-fields"},$e={class:"location-edit-form-buttons"},Re=["href"],je={class:"location-fields-container"},Ae={class:"min-w-full divide-y divide-gray-200 border-separate"},Oe=e("thead",{class:"bg-gray-200 border"},[e("tr",null,[e("th",{scope:"col",class:"px-2 py-3 text-xs font-bold text-left text-gray-700 border"}," Name "),e("th",{scope:"col",class:"px-2 py-3 text-xs font-bold text-left text-gray-700 border"}," Type "),e("th",{scope:"col",class:"px-2 py-3 text-xs font-bold text-left text-gray-700 border"}," Label "),e("th",{scope:"col",class:"px-2 py-3 text-xs font-bold text-left text-gray-700 border"}," Required? "),e("th",{scope:"col",style:{"max-width":"100px"},class:"px-2 py-3 text-xs font-bold text-left text-gray-700 border"}," Data "),e("th",{scope:"col",class:"px-2 py-3 text-xs font-bold text-left text-gray-700 border"}," Max "),e("th",{scope:"col",class:"px-2 py-3 text-xs font-bold text-left text-gray-700 border"}," Min "),e("th",{scope:"col",class:"px-2 py-3 text-xs font-bold text-left text-gray-700 border"}," Lines "),e("th",{scope:"col",class:"px-2 py-3 text-xs font-bold text-left text-gray-700 border"}," Default ")])],-1),Pe=["id"],ze={class:"px-2 py-4 text-sm font-medium text-gray-800 whitespace-nowrap border"},He={class:"px-2 py-4 text-sm font-medium text-gray-800 whitespace-nowrap border"},Je={class:"px-2 py-4 text-sm font-medium text-gray-800 whitespace-nowrap border"},Ye={class:"px-2 py-4 text-sm font-medium text-gray-800 whitespace-nowrap border"},Ge={class:"px-2 py-4 text-sm font-medium text-gray-800 whitespace-nowrap border",style:{"max-width":"200px"}},Ke={class:"px-2 py-4 text-sm font-medium text-gray-800 whitespace-nowrap border"},Qe={class:"px-2 py-4 text-sm font-medium text-gray-800 whitespace-nowrap border"},We={class:"px-2 py-4 text-sm font-medium text-gray-800 whitespace-nowrap border"},Xe={class:"px-2 py-4 text-sm font-medium text-gray-800 whitespace-nowrap border"},Ze={class:"location-fields-modal-grid"},et={class:"px-2"},tt={class:"px-2"},lt=e("option",{value:"string"}," String ",-1),ot=e("option",{value:"integer"}," Integer ",-1),st=e("option",{value:"font"}," Font ",-1),at=e("option",{value:"picker"}," Color Picker ",-1),rt=e("option",{value:"select"}," Drop Down ",-1),it=e("option",{value:"textarea"}," Text Box ",-1),nt=[lt,ot,st,at,rt,it],dt={class:"px-2"},ut={class:"px-2"},mt={class:"px-2"},ct={class:"px-2"},ft={class:"px-2"},pt={class:"px-2"},yt=e("span",{style:{width:"20px"}},null,-1),Lt={__name:"EditLocationsForm",props:{location:{type:Object,default:()=>({})},locations:{type:Object,default:()=>({})},canEditLocations:{type:Boolean,default:()=>!1},canAddLocations:{type:Boolean,default:()=>!1},canDeleteLocations:{type:Boolean,default:()=>!1},canAddFields:{type:Boolean,default:()=>!1},formMode:{type:String,default:()=>""}},setup(k){const f=k,T=se(),V=v(!1);let E=v("");const L=ae({get(){return E.value?E.value:T.props.flash.message},set(t){E.value=t}}),S=()=>{V.value=!0,document.getElementById("alertnotification")&&(document.getElementById("alertnotification").style="display:justify;")},A=()=>{V.value=!1,document.getElementById("alertnotification")&&(document.getElementById("alertnotification").style="display:none;")};N(T.props,function(t){t!=null&&t.flashMessage&&S()},{immediate:!0,deep:!0}),N(L,(t,l)=>{t&&S()},{immediate:!0,deep:!0});const x=v(null),b=v(null),p=v(null),M=v(!1),U=v(!1),a=re("editLocation",{_method:"PUT",id:f.locations.id,name:f.locations.name,category:f.locations.category,description:f.locations.description,full_url:f.locations.full_url,thumbnail:f.locations.thumbnail,fields:f.locations.fields,photo:null,manifest:null}),O=()=>{U.value=!U.value},P=()=>{M.value=!0},z=()=>{fieldCreateForm.clearErrors(),fieldCreateForm.type==""&&fieldCreateForm.setError("type","Type required."),fieldCreateForm.name==""&&fieldCreateForm.setError("name","Name required."),fieldCreateForm.label==""&&fieldCreateForm.setError("label","Label required."),fieldCreateForm.default==""&&fieldCreateForm.setError("default","Default value required."),fieldCreateForm.required==""&&fieldCreateForm.setError("required","Required required."),(fieldCreateForm.type=="string"||fieldCreateForm.type=="integer")&&fieldCreateForm.max==""&&fieldCreateForm.setError("max","Max required."),(fieldCreateForm.type=="string"||fieldCreateForm.type=="integer")&&fieldCreateForm.min==""&&fieldCreateForm.setError("min","Min required."),(fieldCreateForm.type=="string"||fieldCreateForm.type=="integer")&&fieldCreateForm.lines==""&&fieldCreateForm.setError("min","Lines required."),!(Object.keys(fieldCreateForm.errors).length>0)&&fieldCreateForm.post(route("location_fields.store"),{onSuccess:()=>q(),onError:()=>fieldCreateForm.focus(),onFinish:()=>fieldCreateForm.reset()})},H=()=>{const t=b.value.files[0];if(!t)return;const l=new FileReader;l.onload=o=>{x.value=o.target.result},l.readAsDataURL(t)},J=()=>{const t=p.value.files[0];if(!t)return;const l=new FileReader;l.onload=o=>{a.full_url=o.target.result},l.readAsDataURL(t)},Y=()=>{b.value.click()},G=()=>{D.delete(route("location_thumb.destroy",f.locations.id),{preserveScroll:!0,preserveState:!1,resetOnSuccess:!0,onSuccess:()=>{x.value=null,Z()}})},K=()=>{a.clearErrors(),b.value&&(a.photo=b.value.files[0]),p.value&&(a.manifest=p.value.files[0]),a.name==""&&(a.setError("name","Location Name required."),document.getElementById("location_name").classList.add("form-error-input")),!(Object.keys(a.errors).length>0)&&(f.formMode=="edit"?a.post(route("locations.update"),{onError:()=>a.focus(),onFinish:()=>a.reset()}):a.post(route("locations.store"),{onError:()=>a.focus(),onFinish:()=>a.reset()}))},Q=()=>{p.value.click()},W=()=>{X()};p.value&&(a.full_url=p.value.files[0]);const X=()=>{var t;(t=p.value)!=null&&t.value&&(p.value.value=null),a.full_url="",a.manifest=null},Z=()=>{var t;(t=b.value)!=null&&t.value&&(b.value.value=null)},q=()=>{M.value=!1};let I=[];const ee=t=>{let l="";return typeof t=="object"?(l+="Problem updating location! (records with issues marked in red)<br/>",Object.entries(t).forEach(o=>{const[le,oe]=o;I.push(le),l+=oe}),l):t},te=t=>{t.forEach(l=>{document.getElementById(l)!==null&&(document.getElementById(l).className="location-row-color-error")})};return D.on("success",()=>{te(I)}),(t,l)=>(n(),y($,null,[s(me,null,{title:i(()=>[pe,e("div",ye,[g(s(B,{onClick:l[0]||(l[0]=o=>P())},{default:i(()=>[m(" Add Field ")]),_:1},512),[[_,k.canAddFields]])])]),form:i(()=>[g(e("div",ge,[he,e("p",{innerHTML:r(L)?ee(r(L)):""},null,8,be),e("span",ve,[(n(),y("svg",{class:"fill-current h-6 w-6 text-indigo-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",onClick:l[1]||(l[1]=o=>A())},Ce))])],512),[[_,V.value]]),e("div",{class:de(r(a).thumbnail||x.value?"grid grid-cols-5 gap-2 bg-gray-50 border py-4":"grid grid-cols-4 gap-2 bg-gray-50 border py-4")},[e("div",Fe,[s(d,{for:"name",value:"Name"}),s(h,{id:"location_name",modelValue:r(a).name,"onUpdate:modelValue":l[2]||(l[2]=o=>r(a).name=o),name:"name",type:"text",class:"block w-full"},null,8,["modelValue"]),s(u,{message:r(a).errors.name},null,8,["message"])]),e("div",we,[s(d,{for:"category",value:"Category"}),g(e("select",{id:"category","onUpdate:modelValue":l[3]||(l[3]=o=>r(a).category=o),name:"category",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm location-fields-modal-category"},Ee,512),[[R,r(a).category]]),s(u,{message:r(a).errors.category},null,8,["message"])]),e("div",Le,[s(d,{for:"description",value:"Description"}),s(h,{id:"description",modelValue:r(a).description,"onUpdate:modelValue":l[4]||(l[4]=o=>r(a).description=o),name:"description",type:"text",class:"block w-full"},null,8,["modelValue"]),s(u,{message:r(a).errors.description},null,8,["message"])]),t.manifestUpload?(n(),y("div",Me,[s(d,{for:"full_url",value:"Manifest",class:"hidden"}),r(a).full_url?(n(),F(C,{key:0,type:"button",class:"mt-2 location-fields-modal-thumb-btn",onClick:w(W,["prevent"])},{default:i(()=>[m(" Remove URL ")]),_:1},8,["onClick"])):(n(),F(C,{key:1,class:"mt-2 location-fields-modal-thumb-btn",type:"button",onClick:w(Q,["prevent"])},{default:i(()=>[m(" Set URL ")]),_:1},8,["onClick"])),e("input",{ref_key:"manifestInput",ref:p,type:"file",class:"hidden",onChange:J},null,544),s(u,{message:r(a).errors.full_url,class:"mt-2"},null,8,["message"])])):(n(),y("div",Ue,[s(d,{for:"full_url",value:"Full URL"}),s(h,{id:"full_url",modelValue:r(a).full_url,"onUpdate:modelValue":l[5]||(l[5]=o=>r(a).full_url=o),name:"full_url",type:"text",class:"block w-full"},null,8,["modelValue"]),s(u,{message:r(a).errors.full_url},null,8,["message"])])),t.thumbnailUpload?(n(),y("div",qe,[r(a).thumbnail?(n(),F(C,{key:0,type:"button",class:"mt-2 location-fields-modal-thumb-btn",onClick:w(G,["prevent"])},{default:i(()=>[m(" Remove Thumbnail ")]),_:1},8,["onClick"])):(n(),F(C,{key:1,class:"mt-2 location-fields-modal-thumb-btn",type:"button",onClick:w(Y,["prevent"])},{default:i(()=>[m(" Upload Thumbnail ")]),_:1},8,["onClick"])),s(u,{message:r(a).errors.thumbnail,class:"mt-2"},null,8,["message"])])):j("",!0),g(e("div",Be,[s(d,{for:"thumbnail",value:"Thumbnail"}),e("input",{ref_key:"photoInput",ref:b,type:"file",class:"hidden",onChange:H},null,544),x.value&&!r(a).thumbnail?(n(),y("div",Te,[e("span",{class:"location-thumbnail-preview",style:ne("background-image: url('"+x.value+"');")},null,4)])):(n(),y("div",Se,[e("img",{class:"location-thumbnail-image",src:t.$page.props.locations.thumbnail_photo_url,alt:"location-thumbnail"},null,8,Ie)]))],512),[[_,r(a).thumbnail||x.value]])],2)]),actions:i(()=>[e("div",Ne,[e("div",De,[k.canAddFields?(n(),F(B,{key:0,onClick:O},{default:i(()=>[m(" Show Fields ")]),_:1})):j("",!0)]),e("div",$e,[e("a",{href:t.route("locations.index")},[s(C,{type:"button",class:"mr-2"},{default:i(()=>[m(" Cancel ")]),_:1})],8,Re),s(B,{onClick:K},{default:i(()=>[m(" Save Location ")]),_:1})])])]),_:1}),g(e("div",je,[e("table",Ae,[Oe,e("tbody",null,[(n(!0),y($,null,ie(t.locationFields,o=>(n(),y("tr",{id:o.id,key:o.id},[e("td",ze,c(o.name),1),e("td",He,c(o.type),1),e("td",Je,c(o.label),1),e("td",Ye,c(o.required),1),e("td",Ge,[e("pre",null,c(o.json_data),1)]),e("td",Ke,c(o.max),1),e("td",Qe,c(o.min),1),e("td",We,c(o.lines),1),e("td",Xe,c(o.default),1)],8,Pe))),128))])])],512),[[_,U.value]]),s(ce,{show:M.value,"max-width":"max",onClose:l[15]||(l[15]=o=>q())},{title:i(()=>[e("span",null,[e("b",null,c(r(a).name),1),m(" Field:")])]),content:i(()=>[e("div",Ze,[e("div",et,[s(d,{for:"name",value:"Name"}),s(h,{id:"name",modelValue:t.fieldCreateForm.name,"onUpdate:modelValue":l[6]||(l[6]=o=>t.fieldCreateForm.name=o),name:"name",type:"text",class:"block w-full"},null,8,["modelValue"]),s(u,{message:t.fieldCreateForm.errors.name},null,8,["message"])]),e("div",tt,[s(d,{for:"type",value:"Type"}),g(e("select",{id:"type","onUpdate:modelValue":l[7]||(l[7]=o=>t.fieldCreateForm.type=o),name:"type",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm planners-edit-class-code-input location-field-select"},nt,512),[[R,t.fieldCreateForm.type]]),s(u,{message:t.fieldCreateForm.errors.type},null,8,["message"])]),e("div",dt,[s(d,{for:"label",value:"Label"}),s(h,{id:"label",modelValue:t.fieldCreateForm.label,"onUpdate:modelValue":l[8]||(l[8]=o=>t.fieldCreateForm.label=o),name:"label",type:"text",class:"block w-full"},null,8,["modelValue"]),s(u,{message:t.fieldCreateForm.errors.label},null,8,["message"])]),e("div",ut,[s(d,{for:"default",value:"Default"}),s(h,{id:"default",modelValue:t.fieldCreateForm.default,"onUpdate:modelValue":l[9]||(l[9]=o=>t.fieldCreateForm.default=o),name:"default",type:"text",class:"block w-full"},null,8,["modelValue"]),s(u,{message:t.fieldCreateForm.errors.default},null,8,["message"])]),g(e("div",mt,[s(d,{for:"max",value:"Max"}),s(h,{id:"max",modelValue:t.fieldCreateForm.max,"onUpdate:modelValue":l[10]||(l[10]=o=>t.fieldCreateForm.max=o),name:"max",type:"text",class:"block w-full"},null,8,["modelValue"]),s(u,{message:t.fieldCreateForm.errors.max},null,8,["message"])],512),[[_,t.fieldCreateForm.type=="string"||t.fieldCreateForm.type=="integer"||t.fieldCreateForm.type=="textarea"]]),g(e("div",ct,[s(d,{for:"min",value:"Min"}),s(h,{id:"min",modelValue:t.fieldCreateForm.min,"onUpdate:modelValue":l[11]||(l[11]=o=>t.fieldCreateForm.min=o),name:"min",type:"text",class:"block w-full"},null,8,["modelValue"]),s(u,{message:t.fieldCreateForm.errors.min},null,8,["message"])],512),[[_,t.fieldCreateForm.type=="string"||t.fieldCreateForm.type=="integer"||t.fieldCreateForm.type=="textarea"]]),g(e("div",ft,[s(d,{for:"lines",value:"Lines"}),s(h,{id:"lines",modelValue:t.fieldCreateForm.lines,"onUpdate:modelValue":l[12]||(l[12]=o=>t.fieldCreateForm.lines=o),name:"lines",type:"text",class:"block w-full"},null,8,["modelValue"]),s(u,{message:t.fieldCreateForm.errors.lines},null,8,["message"])],512),[[_,t.fieldCreateForm.type=="string"||t.fieldCreateForm.type=="integer"||t.fieldCreateForm.type=="textarea"]]),e("div",pt,[s(d,{for:"required",value:"Required?"}),s(fe,{modelValue:t.fieldCreateForm.required,"onUpdate:modelValue":l[13]||(l[13]=o=>t.fieldCreateForm.required=o),onlabel:"Yes",offlabel:"No",labelledby:"toggle-label",describedby:"toggle-description","false-value":"0","true-value":"1",classes:{container:"mt-2 focus:ring focus:ring-white-500 focus:ring-opacity-30"}},null,8,["modelValue"])])])]),footer:i(()=>[s(C,{onClick:l[14]||(l[14]=o=>q())},{default:i(()=>[m(" Cancel ")]),_:1}),yt,s(ue,{onClick:z},{default:i(()=>[m(" Save ")]),_:1})]),_:1},8,["show"])],64))}};export{Lt as default};
