import{J as ne,r as b,i as re,q as j,v as D,O as $,d as g,b as o,w as i,l as _,m as v,a as e,F as R,g as ie,o as d,f as p,u as l,y as O,c as E,z as C,e as A,D as de,n as ue,t as f}from"./app-262a2786.js";import{_ as x}from"./TextInput-bbe8df5b.js";import{_ as V}from"./SecondaryButton-d3277a63.js";import{_ as me}from"./DangerButton-8bd23b7f.js";import{_ as pe}from"./FormSectionWide-371a92bf.js";import{_ as L}from"./PrimaryButton-a709ea04.js";import{_ as ce}from"./DialogModal-370dc470.js";import{_ as m}from"./InputError-5f2d5f55.js";import{_ as u}from"./InputLabel-0afd5ac9.js";import{T as fe}from"./ToggleButton-2e04d601.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./Modal-e32cf43d.js";const ye=e("div",{style:{width:"50%",float:"left","text-align":"left"}},[e("span",null,"Template:")],-1),ge={style:{width:"50%",float:"left","text-align":"right"}},_e={id:"alertnotification",class:"flex justify-end items-center scala-alert text-white text-sm font-bold px-4 py-3",role:"alert"},xe=e("svg",{class:"fill-current w-4 h-4 mr-2",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[e("path",{d:"M12.432 0c1.34 0 2.01.912 2.01 1.957 0 1.305-1.164 2.512-2.679 2.512-1.269 0-2.009-.75-1.974-1.99C9.789 1.436 10.67 0 12.432 0zM8.309 20c-1.058 0-1.833-.652-1.093-3.524l1.214-5.092c.211-.814.246-1.141 0-1.141-.317 0-1.689.562-2.502 1.117l-.528-.88c2.572-2.186 5.531-3.467 6.801-3.467 1.057 0 1.233 1.273.705 3.23l-1.391 5.352c-.246.945-.141 1.271.106 1.271.317 0 1.357-.392 2.379-1.207l.6.814C12.098 19.02 9.365 20 8.309 20z"})],-1),he=["innerHTML"],be={class:"px-4 py-3 justify-end"},ve=e("title",null,"Close",-1),we=e("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"},null,-1),ke=[ve,we],Ve={class:"px-2"},Ee={class:"px-2"},Ce=e("option",{value:"pedestrian"}," Pedestrian ",-1),Fe=e("option",{value:"pedestrian_emergency"}," Pedestrian Emergency ",-1),Te=e("option",{value:"curbside"}," Curbside ",-1),Me=e("option",{value:"samples"}," Samples ",-1),Ue=[Ce,Fe,Te,Me],Be={class:"px-2"},qe={key:0,class:"px-2"},Le={key:1,class:"px-2"},Se={key:2,class:"px-2"},Ie={class:"px-2"},Ne={key:0},je={key:1},De=["src"],$e={class:"template-edit-form-actions"},Re={class:"template-edit-show-fields"},Oe={class:"template-edit-form-buttons"},Ae=["href"],Pe={class:"template-fields-container"},ze={class:"min-w-full divide-y divide-gray-200 border-separate"},He=e("thead",{class:"bg-gray-200 border"},[e("tr",null,[e("th",{scope:"col",class:"px-2 py-3 text-xs font-bold text-left text-gray-700 border"}," Name "),e("th",{scope:"col",class:"px-2 py-3 text-xs font-bold text-left text-gray-700 border"}," Type "),e("th",{scope:"col",class:"px-2 py-3 text-xs font-bold text-left text-gray-700 border"}," Label "),e("th",{scope:"col",class:"px-2 py-3 text-xs font-bold text-left text-gray-700 border"}," Required? "),e("th",{scope:"col",style:{"max-width":"100px"},class:"px-2 py-3 text-xs font-bold text-left text-gray-700 border"}," Data "),e("th",{scope:"col",class:"px-2 py-3 text-xs font-bold text-left text-gray-700 border"}," Max "),e("th",{scope:"col",class:"px-2 py-3 text-xs font-bold text-left text-gray-700 border"}," Min "),e("th",{scope:"col",class:"px-2 py-3 text-xs font-bold text-left text-gray-700 border"}," Lines "),e("th",{scope:"col",class:"px-2 py-3 text-xs font-bold text-left text-gray-700 border"}," Default ")])],-1),Je=["id"],Ye={class:"px-2 py-4 text-sm font-medium text-gray-800 whitespace-nowrap border"},Ge={class:"px-2 py-4 text-sm font-medium text-gray-800 whitespace-nowrap border"},Ke={class:"px-2 py-4 text-sm font-medium text-gray-800 whitespace-nowrap border"},Qe={class:"px-2 py-4 text-sm font-medium text-gray-800 whitespace-nowrap border"},We={class:"px-2 py-4 text-sm font-medium text-gray-800 whitespace-nowrap border",style:{"max-width":"200px"}},Xe={class:"px-2 py-4 text-sm font-medium text-gray-800 whitespace-nowrap border"},Ze={class:"px-2 py-4 text-sm font-medium text-gray-800 whitespace-nowrap border"},et={class:"px-2 py-4 text-sm font-medium text-gray-800 whitespace-nowrap border"},tt={class:"px-2 py-4 text-sm font-medium text-gray-800 whitespace-nowrap border"},lt={class:"template-fields-modal-grid"},st={class:"px-2"},at={class:"px-2"},ot=e("option",{value:"string"}," String ",-1),nt=e("option",{value:"integer"}," Integer ",-1),rt=e("option",{value:"font"}," Font ",-1),it=e("option",{value:"picker"}," Color Picker ",-1),dt=e("option",{value:"select"}," Drop Down ",-1),ut=e("option",{value:"textarea"}," Text Box ",-1),mt=[ot,nt,rt,it,dt,ut],pt={class:"px-2"},ct={class:"px-2"},ft={class:"px-2"},yt={class:"px-2"},gt={class:"px-2"},_t={class:"px-2"},xt=e("span",{style:{width:"20px"}},null,-1),Bt={__name:"EditTemplatesForm",props:{template:{type:Object,default:()=>({})},templates:{type:Object,default:()=>({})},templateField:{type:Object,default:()=>({})},templateFields:{type:Object,default:()=>({})},canEditTemplates:{type:Boolean,default:()=>!1},canAddTemplates:{type:Boolean,default:()=>!1},canDeleteTemplates:{type:Boolean,default:()=>!1},canAddFields:{type:Boolean,default:()=>!1},formMode:{type:String,default:()=>""},manifestUpload:{type:Boolean,default:()=>!1},thumbnailUpload:{type:Boolean,default:()=>!1}},setup(w){const c=w,S=ne(),F=b(!1);let T=b("");const M=re({get(){return T.value?T.value:S.props.flash.message},set(r){T.value=r}}),I=()=>{F.value=!0,document.getElementById("alertnotification")&&(document.getElementById("alertnotification").style="display:justify;")},P=()=>{F.value=!1,document.getElementById("alertnotification")&&(document.getElementById("alertnotification").style="display:none;")};j(S.props,function(r){r!=null&&r.flashMessage&&I()},{immediate:!0,deep:!0}),j(M,(r,s)=>{r&&I()},{immediate:!0,deep:!0});const k=b(null),h=b(null),y=b(null),U=b(!1),B=b(!1),n=D("editTemplate",{_method:"PUT",id:c.templates.id,name:c.templates.name,category:c.templates.category,description:c.templates.description,full_url:c.templates.full_url,thumbnail:c.templates.thumbnail,fields:c.templates.fields,photo:null,manifest:null}),t=D("fieldCreateForm",{template_id:c.templates.id,name:"",type:"string",label:"",required:"",json_data:{},max:"",min:"",lines:"",default:""}),z=()=>{B.value=!B.value},H=()=>{U.value=!0},J=()=>{t.clearErrors(),t.type==""&&t.setError("type","Type required."),t.name==""&&t.setError("name","Name required."),t.label==""&&t.setError("label","Label required."),t.default==""&&t.setError("default","Default value required."),t.required==""&&t.setError("required","Required required."),(t.type=="string"||t.type=="integer")&&t.max==""&&t.setError("max","Max required."),(t.type=="string"||t.type=="integer")&&t.min==""&&t.setError("min","Min required."),(t.type=="string"||t.type=="integer")&&t.lines==""&&t.setError("min","Lines required."),!(Object.keys(t.errors).length>0)&&t.post(route("template_fields.store"),{onSuccess:()=>q(),onError:()=>t.focus(),onFinish:()=>t.reset()})},Y=()=>{const r=h.value.files[0];if(!r)return;const s=new FileReader;s.onload=a=>{k.value=a.target.result},s.readAsDataURL(r)},G=()=>{const r=y.value.files[0];if(!r)return;const s=new FileReader;s.onload=a=>{n.full_url=a.target.result},s.readAsDataURL(r)},K=()=>{h.value.click()},Q=()=>{$.delete(route("template_thumb.destroy",c.templates.id),{preserveScroll:!0,preserveState:!1,resetOnSuccess:!0,onSuccess:()=>{k.value=null,te()}})},W=()=>{n.clearErrors(),h.value&&(n.photo=h.value.files[0]),y.value&&(n.manifest=y.value.files[0]),n.name==""&&(n.setError("name","Template Name required."),document.getElementById("template_name").classList.add("form-error-input")),!(Object.keys(n.errors).length>0)&&(c.formMode=="edit"?n.post(route("templates.update"),{onError:()=>n.focus(),onFinish:()=>n.reset()}):n.post(route("templates.store"),{onError:()=>n.focus(),onFinish:()=>n.reset()}))},X=()=>{y.value.click()},Z=()=>{ee()};y.value&&(n.full_url=y.value.files[0]);const ee=()=>{var r;(r=y.value)!=null&&r.value&&(y.value.value=null),n.full_url="",n.manifest=null},te=()=>{var r;(r=h.value)!=null&&r.value&&(h.value.value=null)},q=()=>{U.value=!1};let N=[];const le=r=>{let s="";return typeof r=="object"?(s+="Problem updating template! (records with issues marked in red)<br/>",Object.entries(r).forEach(a=>{const[ae,oe]=a;N.push(ae),s+=oe}),s):r},se=r=>{r.forEach(s=>{document.getElementById(s)!==null&&(document.getElementById(s).className="template-row-color-error")})};return $.on("success",()=>{se(N)}),(r,s)=>(d(),g(R,null,[o(pe,null,{title:i(()=>[ye,e("div",ge,[_(o(L,{onClick:s[0]||(s[0]=a=>H())},{default:i(()=>[p(" Add Field ")]),_:1},512),[[v,w.canAddFields]])])]),form:i(()=>[_(e("div",_e,[xe,e("p",{innerHTML:l(M)?le(l(M)):""},null,8,he),e("span",be,[(d(),g("svg",{class:"fill-current h-6 w-6 text-indigo-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",onClick:s[1]||(s[1]=a=>P())},ke))])],512),[[v,F.value]]),e("div",{class:ue(l(n).thumbnail||k.value?"grid grid-cols-5 gap-2 bg-gray-50 border py-4":"grid grid-cols-4 gap-2 bg-gray-50 border py-4")},[e("div",Ve,[o(u,{for:"name",value:"Name"}),o(x,{id:"template_name",modelValue:l(n).name,"onUpdate:modelValue":s[2]||(s[2]=a=>l(n).name=a),name:"name",type:"text",class:"block w-full"},null,8,["modelValue"]),o(m,{message:l(n).errors.name},null,8,["message"])]),e("div",Ee,[o(u,{for:"category",value:"Category"}),_(e("select",{id:"category","onUpdate:modelValue":s[3]||(s[3]=a=>l(n).category=a),name:"category",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm template-fields-modal-category"},Ue,512),[[O,l(n).category]]),o(m,{message:l(n).errors.category},null,8,["message"])]),e("div",Be,[o(u,{for:"description",value:"Description"}),o(x,{id:"description",modelValue:l(n).description,"onUpdate:modelValue":s[4]||(s[4]=a=>l(n).description=a),name:"description",type:"text",class:"block w-full"},null,8,["modelValue"]),o(m,{message:l(n).errors.description},null,8,["message"])]),w.manifestUpload?(d(),g("div",qe,[o(u,{for:"full_url",value:"Manifest",class:"hidden"}),l(n).full_url?(d(),E(V,{key:0,type:"button",class:"mt-2 template-fields-modal-thumb-btn",onClick:C(Z,["prevent"])},{default:i(()=>[p(" Remove URL ")]),_:1},8,["onClick"])):(d(),E(V,{key:1,class:"mt-2 template-fields-modal-thumb-btn",type:"button",onClick:C(X,["prevent"])},{default:i(()=>[p(" Set URL ")]),_:1},8,["onClick"])),e("input",{ref_key:"manifestInput",ref:y,type:"file",class:"hidden",onChange:G},null,544),o(m,{message:l(n).errors.full_url,class:"mt-2"},null,8,["message"])])):(d(),g("div",Le,[o(u,{for:"full_url",value:"Full URL"}),o(x,{id:"full_url",modelValue:l(n).full_url,"onUpdate:modelValue":s[5]||(s[5]=a=>l(n).full_url=a),name:"full_url",type:"text",class:"block w-full"},null,8,["modelValue"]),o(m,{message:l(n).errors.full_url},null,8,["message"])])),w.thumbnailUpload?(d(),g("div",Se,[l(n).thumbnail?(d(),E(V,{key:0,type:"button",class:"mt-2 template-fields-modal-thumb-btn",onClick:C(Q,["prevent"])},{default:i(()=>[p(" Remove Thumbnail ")]),_:1},8,["onClick"])):(d(),E(V,{key:1,class:"mt-2 template-fields-modal-thumb-btn",type:"button",onClick:C(K,["prevent"])},{default:i(()=>[p(" Upload Thumbnail ")]),_:1},8,["onClick"])),o(m,{message:l(n).errors.thumbnail,class:"mt-2"},null,8,["message"])])):A("",!0),_(e("div",Ie,[o(u,{for:"thumbnail",value:"Thumbnail"}),e("input",{ref_key:"photoInput",ref:h,type:"file",class:"hidden",onChange:Y},null,544),k.value&&!l(n).thumbnail?(d(),g("div",Ne,[e("span",{class:"template-thumbnail-preview",style:de("background-image: url('"+k.value+"');")},null,4)])):(d(),g("div",je,[e("img",{class:"template-thumbnail-image",src:r.$page.props.templates.thumbnail_photo_url,alt:"template-thumbnail"},null,8,De)]))],512),[[v,l(n).thumbnail||k.value]])],2)]),actions:i(()=>[e("div",$e,[e("div",Re,[w.canAddFields?(d(),E(L,{key:0,onClick:z},{default:i(()=>[p(" Show Fields ")]),_:1})):A("",!0)]),e("div",Oe,[e("a",{href:r.route("templates.index")},[o(V,{type:"button",class:"mr-2"},{default:i(()=>[p(" Cancel ")]),_:1})],8,Ae),o(L,{onClick:W},{default:i(()=>[p(" Save Template ")]),_:1})])])]),_:1}),_(e("div",Pe,[e("table",ze,[He,e("tbody",null,[(d(!0),g(R,null,ie(w.templateFields,a=>(d(),g("tr",{id:a.id,key:a.id},[e("td",Ye,f(a.name),1),e("td",Ge,f(a.type),1),e("td",Ke,f(a.label),1),e("td",Qe,f(a.required),1),e("td",We,[e("pre",null,f(a.json_data),1)]),e("td",Xe,f(a.max),1),e("td",Ze,f(a.min),1),e("td",et,f(a.lines),1),e("td",tt,f(a.default),1)],8,Je))),128))])])],512),[[v,B.value]]),o(ce,{show:U.value,"max-width":"max",onClose:s[15]||(s[15]=a=>q())},{title:i(()=>[e("span",null,[e("b",null,f(l(n).name),1),p(" Field:")])]),content:i(()=>[e("div",lt,[e("div",st,[o(u,{for:"name",value:"Name"}),o(x,{id:"name",modelValue:l(t).name,"onUpdate:modelValue":s[6]||(s[6]=a=>l(t).name=a),name:"name",type:"text",class:"block w-full"},null,8,["modelValue"]),o(m,{message:l(t).errors.name},null,8,["message"])]),e("div",at,[o(u,{for:"type",value:"Type"}),_(e("select",{id:"type","onUpdate:modelValue":s[7]||(s[7]=a=>l(t).type=a),name:"type",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm planners-edit-class-code-input template-field-select"},mt,512),[[O,l(t).type]]),o(m,{message:l(t).errors.type},null,8,["message"])]),e("div",pt,[o(u,{for:"label",value:"Label"}),o(x,{id:"label",modelValue:l(t).label,"onUpdate:modelValue":s[8]||(s[8]=a=>l(t).label=a),name:"label",type:"text",class:"block w-full"},null,8,["modelValue"]),o(m,{message:l(t).errors.label},null,8,["message"])]),e("div",ct,[o(u,{for:"default",value:"Default"}),o(x,{id:"default",modelValue:l(t).default,"onUpdate:modelValue":s[9]||(s[9]=a=>l(t).default=a),name:"default",type:"text",class:"block w-full"},null,8,["modelValue"]),o(m,{message:l(t).errors.default},null,8,["message"])]),_(e("div",ft,[o(u,{for:"max",value:"Max"}),o(x,{id:"max",modelValue:l(t).max,"onUpdate:modelValue":s[10]||(s[10]=a=>l(t).max=a),name:"max",type:"text",class:"block w-full"},null,8,["modelValue"]),o(m,{message:l(t).errors.max},null,8,["message"])],512),[[v,l(t).type=="string"||l(t).type=="integer"||l(t).type=="textarea"]]),_(e("div",yt,[o(u,{for:"min",value:"Min"}),o(x,{id:"min",modelValue:l(t).min,"onUpdate:modelValue":s[11]||(s[11]=a=>l(t).min=a),name:"min",type:"text",class:"block w-full"},null,8,["modelValue"]),o(m,{message:l(t).errors.min},null,8,["message"])],512),[[v,l(t).type=="string"||l(t).type=="integer"||l(t).type=="textarea"]]),_(e("div",gt,[o(u,{for:"lines",value:"Lines"}),o(x,{id:"lines",modelValue:l(t).lines,"onUpdate:modelValue":s[12]||(s[12]=a=>l(t).lines=a),name:"lines",type:"text",class:"block w-full"},null,8,["modelValue"]),o(m,{message:l(t).errors.lines},null,8,["message"])],512),[[v,l(t).type=="string"||l(t).type=="integer"||l(t).type=="textarea"]]),e("div",_t,[o(u,{for:"required",value:"Required?"}),o(fe,{modelValue:l(t).required,"onUpdate:modelValue":s[13]||(s[13]=a=>l(t).required=a),onlabel:"Yes",offlabel:"No",labelledby:"toggle-label",describedby:"toggle-description","false-value":"0","true-value":"1",classes:{container:"mt-2 focus:ring focus:ring-white-500 focus:ring-opacity-30"}},null,8,["modelValue"])])])]),footer:i(()=>[o(V,{onClick:s[14]||(s[14]=a=>q())},{default:i(()=>[p(" Cancel ")]),_:1}),xt,o(me,{onClick:J},{default:i(()=>[p(" Save ")]),_:1})]),_:1},8,["show"])],64))}};export{Bt as default};
